<!doctype html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>USENリクエスト起動</title>

    <!-- iOS: スタンドアロン -->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="apple-mobile-web-app-title" content="USEN起動" />

    <!-- PWA manifest（キャッシュ更新用に ?v=3） -->
    <link rel="manifest" href="./manifest.webmanifest?v=3" />
    <meta name="theme-color" content="#111827" />

    <!-- Project Pages対策: 相対解決 -->
    <base href="./" />

    <style>
      html,body{height:100%;margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,sans-serif}
      body{display:flex;justify-content:center;align-items:center;background:#0b1220;color:#e5e7eb}
      .card{background:#111827;padding:32px;border-radius:16px;box-shadow:0 10px 30px rgba(0,0,0,.25);text-align:center;max-width:560px}
      h1{margin:0 0 8px}
      button{background:#2563eb;color:#fff;border:0;padding:12px 24px;border-radius:10px;font-size:16px;cursor:pointer}
      button:hover{background:#1e40af}
      .small{opacity:.8;font-size:14px;margin-top:12px}
    </style>
  </head>
  <body>
    <div class="card">
      <h1>USENリクエストへ</h1>
      <p>test下のボタンを押すとUSENのリクエストページを開きます。</p>
      <button id="openBtn" type="button">開く</button>
      <p class="small">※ オフライン時は開けません。</p>
    </div>

    <script>
      // Service Worker 登録（scope を ./ に固定）
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('./sw.js?v=3', { scope: './' }).catch(()=>{});
      }

      // 手動遷移（外部ドメインは外部ブラウザで開くのが正常）
      const TARGET = 'https://usen.oshireq.com/song/6299592';
      document.getElementById('openBtn').addEventListener('click', () => {
        window.location.href = TARGET;
      });
    </script>
  </body>
</html>
